################
sphinxcontrib.dd
################

Sphinx extension for Data Dictionary and Database Diagram.

The syntax is using modified `Swagger <http://swagger.io/specification>`__
format.

Database diagram will be generated by `GraphViz <http://www.graphviz.org/>`__.


Installation
============

::

  > pip install sphinxcontrib-dd

In ``conf.py``:

::

  extensions = ['sphinxcontrib.dd']


Schema
======

- `definitions <http://swagger.io/specification/#definitionsObject>`__
- entities
- relationships


entities
--------

===========  ============================
Field Name   Description
===========  ============================
name         Table name
description  Information about the entity
===========  ============================

::

  entities:
    User:
      name: users
      description: Table to stores user information.
      columns:
        $ref: '#/definitions/User'
    Role:
      name: roles
      description: Table to stores roles.
      columns:
        $ref: '#/definitions/Role'
    UserRole:
      name: users_roles
      description: Table to stores user roles.
      columns:
        $ref: '#/definitions/UserRole'


.. note::

  Because swagger spec didn't allow unknown entry (entities),
  it would be better if our ref able to resolve ref to another file.

  Example:

  ``$ref: 'part.yml#/definitions/User``


relationships
-------------

Determine the relationship between two entities.

=========  ===============================================
Symbol     Meaning
=========  ===============================================
\|         One
\|\|       One and only one
\|0 / 0\|  Zero or one
> / <      Many
>0 / 0<    Zero or many
>\| / \|<  One or many
=========  ===============================================

The syntax is ``<symbol>--<symbol>``.

::

  relationships:
    - User |--0< UserRole
    - Role |--0< UserRole


Usage
=====

Generate database diagram using GraphViz:

::

  .. database-diagram:: data.yml

Generate data dictionary table:

::

  .. data-dictionary:: data.yml

You can also type the content as normal directive.


TODO
====

1. Change entity name into h+1 depending on the context.
2. Resolve $ref to another file.
